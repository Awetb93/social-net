(this.webpackJsonpclient2=this.webpackJsonpclient2||[]).push([[0],{157:function(e,t,n){},163:function(e,t,n){"use strict";n.r(t);var c=n(3),r=n(19),i=n(16),a=n(35),s=n(11),o=n(209),l=n.n(o),j=n(120),d=n(0),u=n(37),b=n(21),m=n(202),O=n(212),p=n(198),x=n(201),h=n(129),f=n.n(h),g=n(41),v=n(203),y=n(215),S=n(204),w=n(205),k=n(128),$=n.n(k),C=n(20),I=n(197),q=n(199),N=n(127),U=n.n(N),A=n(126),P=n.n(A),Q=n(76),T=n.n(Q);function F(e){var t=e.comments,n=Object(C.f)(),r=t.map((function(e,t){return Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{className:"comment",children:[Object(c.jsx)(y.a,{onClick:function(){n.push("profile/".concat(e.user.id))},style:{cursor:"pointer"},children:e.user.name.split(" ")[0].split("")[0]}),Object(c.jsxs)("p",{style:{marginLeft:"5px"},children:[T()(parseInt(e.createdAt)).fromNow()," "]})]}),Object(c.jsx)("div",{className:"comment-content",children:Object(c.jsxs)("p",{children:[e.comment,"  "]})})]},t)}));return Object(c.jsx)("div",{children:r})}function J(){var e=Object(b.a)(["\nmutation($comment:String!,$postid:ID!){\n addComment(comment:$comment,postid:$postid){\n    comment,id\n  }\n}\n\n"]);return J=function(){return e},e}function M(){var e=Object(b.a)(["\nmutation($like:Boolean!,$postid:ID!){\n  addLike(like:$like,postid:$postid){\n    owner\n  }\n}\n"]);return M=function(){return e},e}var L=Object(s.gql)(M()),D=Object(s.gql)(J());function E(e){var t=e.state,n=Object(d.useState)(!1),r=Object(i.a)(n,2),a=r[0],o=r[1],l=Object(d.useState)(""),j=Object(i.a)(l,2),u=j[0],b=j[1],m=Object(s.useMutation)(D),h=Object(i.a)(m,1)[0],f=Object(s.useMutation)(L),g=Object(i.a)(f,1)[0];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(I.a,{children:[Object(c.jsxs)(p.a,{onClick:function(){return e=t.id,void g({variables:{like:!0,postid:e},refetchQueries:[{query:G}]});var e},children:[t.likes.length>0?Object(c.jsx)(q.a,{badgeContent:t.likes[0].owner.length,color:"secondary"}):null,Object(c.jsx)(P.a,{})]}),Object(c.jsxs)(p.a,{onClick:function(){return o(!a)},children:[Object(c.jsx)(q.a,{badgeContent:t.comments.length,color:"secondary"}),Object(c.jsx)(U.a,{})]})]}),Object(c.jsx)("div",{children:a&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("hr",{}),Object(c.jsxs)("div",{className:"edit-commont",children:[Object(c.jsx)(y.a,{children:t.user.name.split(" ")[0].split("")[0]}),Object(c.jsx)(O.a,{onChange:function(e){return b(e.target.value)},value:u,required:!0,style:{width:"90%"},placeholder:"write a comment ..."})]}),Object(c.jsx)(x.a,{onClick:function(){return e=t.id,h({variables:{comment:u,postid:e},refetchQueries:[{query:G}]}),void b("");var e},style:{marginLeft:"50%"},children:"Submit"}),Object(c.jsx)(x.a,{onClick:function(){o(!a),o("")},children:"concel"}),Object(c.jsx)(F,{comments:t.comments})]})})]})}function V(e){var t,n=e.posts,r=e.me,i=e.deletePost,a=Object(C.f)();return n&&(t=n.posts.map((function(e){return Object(c.jsx)("div",{children:!0===r?Object(c.jsxs)(m.a,{container:!0,className:"admin-list",children:[Object(c.jsx)(m.a,{item:!0,md:11,sm:11,style:{width:"80%"},children:Object(c.jsxs)(v.a,{style:{marginTop:"10px"},variant:"outlined",children:[Object(c.jsxs)("div",{className:"comment",children:[Object(c.jsx)(y.a,{onClick:function(){return a.push("/profile/".concat(e.user.id))},style:{cursor:"pointer"},children:e.user.name.split(" ")[0].split("")[0]}),Object(c.jsx)(S.a,{subheader:T()(parseInt(e.createdAt)).fromNow()})]}),Object(c.jsxs)(w.a,{children:[Object(c.jsx)("div",{children:e.post}),e.picUrl&&Object(c.jsx)("div",{children:Object(c.jsx)("img",{src:e.picUrl,style:{width:"60%",height:"50%"},alt:e.picName})})]}),Object(c.jsx)(E,{state:e})]})}),Object(c.jsx)(m.a,{item:!0,sm:1,md:1,children:Object(c.jsx)(p.a,{onClick:function(){return i(e.id)},children:Object(c.jsx)($.a,{color:"secondary"})})})]},e.id):Object(c.jsxs)(v.a,{style:{marginTop:"10px"},variant:"outlined",children:[Object(c.jsxs)("div",{className:"comment",children:[Object(c.jsx)(y.a,{onClick:function(){return a.push("/profile/".concat(e.user.id))},style:{cursor:"pointer"},children:e.user.name.split(" ")[0].split("")[0]}),Object(c.jsx)(S.a,{subheader:T()(parseInt(e.createdAt)).fromNow()})]}),Object(c.jsxs)(w.a,{children:[Object(c.jsx)("div",{children:e.post}),e.picUrl&&Object(c.jsx)("div",{children:Object(c.jsx)("img",{src:e.picUrl,style:{width:"60%",height:"50%"},alt:e.picName})})]}),Object(c.jsx)(E,{state:e})]})},e.id)}))),Object(c.jsx)("div",{children:t})}function z(){var e=Object(b.a)(["\nmutation($post:String,$file:Upload){\n    addPost(post:$post,file:$file){\n    post\n  }\n}\n"]);return z=function(){return e},e}function B(){var e=Object(b.a)(["{\n  posts{\n    post  picUrl,picName createdAt id user{\n      name,id \n    }\n    comments{\n        comment createdAt user{\n          name id\n        }\n      }\n       likes{\n      owner\n    }\n  }\n}"]);return B=function(){return e},e}var G=Object(s.gql)(B()),R=Object(s.gql)(z());function W(){var e=Object(g.b)(),t=Object(s.useQuery)(G).data,n=Object(s.useMutation)(R,{onCompleted:function(e){l()}}),r=Object(i.a)(n,1)[0],a=e.control,o=e.handleSubmit,l=e.reset,j=e.register,d=JSON.parse(localStorage.getItem("user"));return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(m.a,{container:!0,style:{marginTop:"20px"},children:[Object(c.jsx)(m.a,{item:!0,sm:4}),Object(c.jsx)(m.a,{item:!0,sm:6,children:Object(c.jsxs)("form",{onSubmit:o((function(e){var t=e.pic[0];r({variables:{post:e.post,file:t},refetchQueries:[{query:G}]})})),children:[Object(c.jsx)("div",{className:"profile-circle",children:d.name[0]}),Object(c.jsx)(g.a,{as:O.a,label:"what is in your mind ".concat(d.name,"?"),variant:"outlined",control:a,name:"post",defaultValue:"",style:{width:"100%"}}),Object(c.jsx)("input",{accept:"image/*",id:"icon-button-file",name:"pic",type:"file",ref:j,hidden:!0}),Object(c.jsx)("label",{htmlFor:"icon-button-file",children:Object(c.jsx)(p.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(c.jsx)(f.a,{})})}),Object(c.jsx)(x.a,{style:{marginLeft:"60%"},className:"btn",type:"submit",children:"Post"})]})}),Object(c.jsx)(m.a,{item:!0,sm:2})]}),Object(c.jsxs)(m.a,{container:!0,style:{marginTop:"20px"},children:[Object(c.jsx)(m.a,{item:!0,sm:4}),Object(c.jsx)(m.a,{item:!0,container:!0,xs:12,sm:6,children:Object(c.jsx)(V,{posts:t})}),Object(c.jsx)(m.a,{item:!0,sm:2})]})]})}function H(){var e=Object(b.a)(["\n  mutation($id:ID!){\n    deletePost(id:$id){\n      id\n    }\n  }\n"]);return H=function(){return e},e}function K(){var e=Object(b.a)(["\nmutation($id:ID!){\n  unfollow(id:$id){\n    id\n  }\n}\n"]);return K=function(){return e},e}function X(){var e=Object(b.a)(["\nmutation($id:ID!){\n  following(id:$id){\n    id\n  }\n}\n"]);return X=function(){return e},e}function Y(){var e=Object(b.a)(["\n    query($id:ID!){\n        user(id:$id){\n        followed\n         posts{\n    post  picUrl,picName createdAt id user{\n      name,id \n    }\n    comments{\n        comment createdAt user{\n          name id\n        }\n      }\n       likes{\n      owner\n    }\n  }   \n        }\n    }\n\n"]);return Y=function(){return e},e}var Z=Object(s.gql)(Y()),_=Object(s.gql)(X()),ee=Object(s.gql)(K()),te=Object(s.gql)(H());function ne(){var e,t=Object(C.g)().id,n=Object(s.useQuery)(Z,{variables:{id:t}}).data,r=JSON.parse(localStorage.getItem("user")),a=Object(s.useMutation)(_),o=Object(i.a)(a,1)[0],l=Object(s.useMutation)(ee),j=Object(i.a)(l,1)[0],d=Object(s.useMutation)(te),u=Object(i.a)(d,1)[0],b=r.id===t;n&&(e=n.user.followed.filter((function(e){return e===r.id.toString()})).length>0?Object(c.jsx)(x.a,{variant:"contained",color:"secondary",onClick:function(){j({variables:{id:t},refetchQueries:[{query:Z,variables:{id:t}}]})},children:"unFollow"}):Object(c.jsx)(x.a,{variant:"contained",color:"primary",onClick:function(){o({variables:{id:t},refetchQueries:[{query:Z,variables:{id:t}}]})},children:"Follow"}));return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(m.a,{container:!0,style:{marginTop:"20px"},children:[Object(c.jsx)(m.a,{item:!0,sm:4}),Object(c.jsx)(m.a,{item:!0,sm:6,children:r.id!==t?e:null}),Object(c.jsx)(m.a,{item:!0,sm:2})]}),Object(c.jsxs)(m.a,{container:!0,style:{marginTop:"20px"},children:[Object(c.jsx)(m.a,{item:!0,sm:4}),n&&Object(c.jsx)(m.a,{item:!0,sm:6,children:Object(c.jsx)(V,{posts:n.user,me:b,deletePost:function(e){u({variables:{id:e},refetchQueries:[{query:Z,variables:{id:t}},{query:G}]})}})}),Object(c.jsx)(m.a,{item:!0,sm:2})]})]})}var ce=n(54),re=n(214),ie=function(e){localStorage.removeItem("user"),localStorage.setItem("user",JSON.stringify(e))};function ae(){var e=Object(b.a)(["\nmutation($email:String!,$password:String!){\n    signIn(email:$email,password:$password){\n        name,token,id\n    }\n}\n"]);return ae=function(){return e},e}var se=Object(s.gql)(ae());function oe(){var e=Object(g.b)(),t=Object(C.f)(),n=e.control,r=e.handleSubmit,o=e.reset,l=Object(d.useContext)(Qe).dispatch,j=Object(s.useMutation)(se,{errorPolicy:"all",onCompleted:function(e){ie(e.signIn);var n=JSON.parse(localStorage.getItem("user"));l({type:"setlocal",payload:n}),t.push("/home/".concat(e.signIn.id))}}),u=Object(i.a)(j,2),b=u[0],m=u[1].error;return Object(c.jsxs)(v.a,{style:{margin:"10px"},elevation:4,children:[Object(c.jsx)(ce.a,{color:"textSecondary",style:{textAlign:"center",marginTop:"10px"},children:"SignIn"}),m&&Object(c.jsx)(re.a,{children:m.graphQLErrors.map((function(e,t){var n=e.message;return Object(c.jsx)("span",{children:n},t)}))}),Object(c.jsx)(w.a,{children:Object(c.jsxs)("form",{onSubmit:r((function(e){b({variables:Object(a.a)({},e)}),o()})),children:[Object(c.jsx)("div",{style:{margin:"10px"},children:Object(c.jsx)(g.a,{as:O.a,name:"email",label:"Email",variant:"outlined",control:n,defaultValue:"",required:!0})}),Object(c.jsx)("div",{style:{margin:"10px"},children:Object(c.jsx)(g.a,{as:O.a,name:"password",label:"Password",variant:"outlined",type:"password",control:n,defaultValue:"",required:!0})}),Object(c.jsxs)(I.a,{children:[Object(c.jsx)(x.a,{type:"submit",children:"login"}),Object(c.jsx)(x.a,{onClick:function(){return l({type:"SignUp",payload:!0})},children:"SignUp"})]})]})})]})}function le(){var e=Object(b.a)(["\nmutation($name:String!,$email:String!,$password:String!){\n    signUp(name:$name,email:$email,password:$password){\n        name,token,id\n    }\n}\n"]);return le=function(){return e},e}var je=Object(s.gql)(le());function de(){var e=Object(g.b)(),t=Object(C.f)(),n=JSON.parse(localStorage.getItem("user"));console.log(n),n&&t.push("home/".concat(n.id));var r=Object(d.useContext)(Qe),o=r.state,l=r.dispatch,j=Object(s.useMutation)(je,{errorPolicy:"all",onCompleted:function(e){ie(e.signUp);var n=JSON.parse(localStorage.getItem("user"));l({type:"setlocal",payload:n}),t.push("/home/".concat(e.signUp.id))}}),u=Object(i.a)(j,2),b=u[0],m=u[1].error,p=e.control,h=e.handleSubmit,f=e.reset,y=o.SignUp;return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)("div",{className:"app",children:[Object(c.jsx)("div",{className:"pic",style:{flexGrow:"1"},children:"welcome"}),Object(c.jsx)("div",{className:"signupform"}),!0===y?Object(c.jsxs)(v.a,{style:{margin:"10px"},elevation:4,children:[Object(c.jsx)(ce.a,{color:"textSecondary",style:{textAlign:"center",marginTop:"10px"},children:"SignUp form"}),m&&Object(c.jsx)(re.a,{children:m.graphQLErrors.map((function(e,t){var n=e.message;return Object(c.jsx)("span",{children:n},t)}))}),Object(c.jsx)(w.a,{children:Object(c.jsxs)("form",{onSubmit:h((function(e){b({variables:Object(a.a)({},e)}),f()})),children:[Object(c.jsx)("div",{style:{margin:"10px"},children:Object(c.jsx)(g.a,{as:O.a,name:"name",label:"Name",variant:"outlined",control:p,defaultValue:"",required:!0})}),Object(c.jsx)("div",{style:{margin:"10px"},children:Object(c.jsx)(g.a,{as:O.a,name:"email",label:"Email",variant:"outlined",control:p,defaultValue:"",required:!0})}),Object(c.jsx)("div",{style:{margin:"10px"},children:Object(c.jsx)(g.a,{as:O.a,name:"password",label:"Password",variant:"outlined",type:"password",control:p,defaultValue:"",required:!0})}),Object(c.jsxs)(I.a,{children:[Object(c.jsx)(x.a,{onClick:function(){return l({type:"SignUp",payload:!1})},children:"login"}),Object(c.jsx)(x.a,{type:"submit",children:"SignUp"})]})]})})]}):Object(c.jsx)(oe,{})]})})}function ue(){return Object(c.jsxs)(C.c,{children:[Object(c.jsx)(C.a,{exact:!0,path:"/",component:de}),Object(c.jsx)(C.a,{exact:!0,path:"/home/:id",component:W}),Object(c.jsx)(C.a,{exact:!0,path:"/profile/:id",component:ne})]})}var be=n(216),me=n(206),Oe=n(200),pe=n(207),xe=n(208),he=Object(me.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper}}}));function fe(e){var t,n=e.items,r=e.onclick,i=he(),a=Object(C.f)();return n&&(console.log(n),n.search.length>0&&(t=n.search.map((function(e,t){return Object(c.jsx)(pe.a,{button:!0,onClick:function(){a.push("/profile/".concat(e.id)),r("")},children:Object(c.jsx)(xe.a,{primary:e.name})},t)})))),Object(c.jsx)("div",{className:i.root,style:{marginTop:"10px"},children:Object(c.jsx)(Oe.a,{component:"nav","aria-label":"main mailbox folders",children:t})})}function ge(){var e=Object(b.a)(["\nmutation($id:ID!){\n    signOut(id:$id){\n        id\n    }\n}\n\n"]);return ge=function(){return e},e}var ve=Object(s.gql)(ge());function ye(e){var t=Object(C.f)(),n=e.id,r=Object(d.useContext)(Qe).dispatch,a=Object(s.useMutation)(ve,{onCompleted:function(e){e&&l()}}),o=Object(i.a)(a,1)[0],l=function(){localStorage.removeItem("user"),localStorage.getItem("user")||(t.push("/"),r({type:"setlocal",payload:""}))};return Object(c.jsx)(x.a,{onClick:function(){o({variables:{id:n}})},children:"Signout"})}function Se(){var e=Object(b.a)(["\nquery($name:String!){\n search(name:$name){\n  name id \n}\n}\n"]);return Se=function(){return e},e}function we(){var e=Object(b.a)(["{\n  posts{\n    post createdAt id user{\n      name,id \n    }\n    comments{\n        comment createdAt user{\n          name id\n        }\n      }\n       likes{\n      owner\n    }\n  }\n}"]);return we=function(){return e},e}Object(s.gql)(we());var ke=Object(s.gql)(Se());function $e(){var e=Object(d.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1],a=Object(s.useLazyQuery)(ke),o=Object(i.a)(a,2),l=o[0],j=o[1],b=JSON.parse(localStorage.getItem("user"));Object(d.useEffect)((function(){var e=setTimeout((function(){n&&l({variables:{name:n}})}),800);return function(){clearTimeout(e)}}),[n,l]);return Object(c.jsx)(c.Fragment,{children:b&&Object(c.jsxs)(m.a,{container:!0,style:{width:"100%"},className:"list",children:[Object(c.jsx)(m.a,{item:!0,xs:12,sm:4,children:Object(c.jsx)("div",{children:b.name})}),Object(c.jsx)(m.a,{item:!0,xs:12,sm:4,children:Object(c.jsxs)("div",{children:[Object(c.jsx)(be.a,{variant:"outlined",size:"small",placeholder:" Search\u2026",onChange:function(e){return r(e.target.value)},value:n}),n&&Object(c.jsx)(fe,{items:j.data,onclick:function(e){r(e)}})]})}),Object(c.jsx)(m.a,{item:!0,sm:2}),Object(c.jsxs)(m.a,{item:!0,xs:12,sm:2,children:[Object(c.jsx)(u.b,{to:"/profile/".concat(b.id),children:"Profile"}),Object(c.jsx)(ye,{id:b.id})]})]})})}var Ce=n(213),Ie=n(210),qe=n(211),Ne=(n(157),l()({uri:"/graphql"})),Ue=Object(j.a)((function(e,t){var n=t.headers,c=JSON.parse(localStorage.getItem("user"));return{headers:Object(a.a)(Object(a.a)({},n),{},{authorization:c?"Bearer ".concat(c.token):""})}})),Ae=new s.ApolloClient({link:s.ApolloLink.from([Ue,Ne]),cache:new s.InMemoryCache}),Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SignUp":return Object(a.a)(Object(a.a)({},e),{},{SignUp:t.payload});case"SignIn":return Object(a.a)(Object(a.a)({},e),{},{isSignIn:!0,user:t.payload});case"setlocal":return Object(a.a)(Object(a.a)({},e),{},{loc:t.payload});default:return e}},Qe=Object(d.createContext)({});var Te=function(){var e=Object(d.useReducer)(Pe,{SignUp:!0,isSignIn:!1,user:{},loc:{}}),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(c.jsx)(s.ApolloProvider,{client:Ae,children:Object(c.jsx)(Qe.Provider,{value:{state:n,dispatch:r},children:Object(c.jsx)(Ce.b,{injectFirst:!0,children:Object(c.jsx)(Ie.a,{children:Object(c.jsx)(qe.a,{children:Object(c.jsxs)(u.a,{children:[Object(c.jsx)($e,{}),Object(c.jsx)(ue,{})]})})})})})})};Object(r.render)(Object(c.jsx)(Te,{}),document.getElementById("root"))}},[[163,1,2]]]);
//# sourceMappingURL=main.9bc1c379.chunk.js.map